# 05-表单控件规范

## 文档信息
- **版本**: 1.0.0
- **最后更新**: 2025-12-21
- **依赖**: [01-设计令牌](./01-设计令牌.md), [02-颜色系统](./02-颜色系统.md), [03-排版系统](./03-排版系统.md)

---

## 概述

本文档定义SillyTavern中所有表单控件的设计规范，包括输入框、文本域、选择器、滑块、开关、复选框等。所有控件遵循统一的交互模式和视觉语言。

---

## 1. 文本输入框 (Text Input)

### 1.1 基础规范

**CSS定义**:
```css
.text_pole {
  background-color: var(--black30a);
  color: var(--SmartThemeBodyColor);
  border: 1px solid var(--SmartThemeBorderColor);
  border-radius: 5px;
  padding: var(--spacing-sm);
  font-family: var(--mainFontFamily);
  font-size: var(--mainFontSize);
  transition: all var(--animation-duration) ease;
}

/* Focus 状态 */
.text_pole:focus {
  outline: 2px solid var(--SmartThemeQuoteColor);
  outline-offset: 2px;
  background-color: var(--black50a);
  border-color: var(--SmartThemeQuoteColor);
}

/* Disabled 状态 */
.text_pole:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background-color: var(--black20a);
}

/* Error 状态 */
.text_pole.error {
  border-color: var(--error-color);
  outline-color: var(--error-color);
}
```

### 1.2 变体定义

| 变体名称 | 应用场景 | 特征 |
|---------|---------|------|
| Default | 普通文本输入 | 单行、固定高度 |
| Textarea | 多行文本输入 | 可调整大小、最小高度 |
| Search | 搜索框 | 带搜索图标、圆角更大 |
| Number | 数字输入 | 右侧带增减按钮 |
| Password | 密码输入 | 遮罩字符、可切换显示 |

### 1.3 尺寸规范

```css
/* 高度定义 */
--input-height-sm: 32px;
--input-height-md: 40px;  /* 默认 */
--input-height-lg: 48px;

/* 内边距 */
--input-padding-sm: 6px 10px;
--input-padding-md: 8px 12px;
--input-padding-lg: 12px 16px;
```

### 1.4 状态定义

**状态表格**:
| 状态 | 背景色 | 边框色 | 光标 | 说明 |
|-----|--------|--------|------|------|
| Default | black30a | SmartThemeBorderColor | text | 默认状态 |
| Hover | black40a | SmartThemeBorderColor | pointer | 鼠标悬停 |
| Focus | black50a | SmartThemeQuoteColor | text | 聚焦输入 |
| Filled | black30a | SmartThemeBorderColor | text | 已填内容 |
| Error | black30a | error-color | text | 验证失败 |
| Disabled | black20a | SmartThemeBorderColor | not-allowed | 禁用状态 |

---

## 2. 选择器 (Select)

### 2.1 基础规范

**CSS定义**:
```css
select {
  background-color: var(--black30a);
  color: var(--SmartThemeBodyColor);
  border: 1px solid var(--SmartThemeBorderColor);
  border-radius: 5px;
  padding: var(--spacing-sm);
  font-family: var(--mainFontFamily);
  font-size: var(--mainFontSize);
  cursor: pointer;
  appearance: none;  /* 移除默认样式 */
  background-image: url("data:image/svg+xml,...");  /* 自定义下拉箭头 */
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;
}

/* Hover 状态 */
select:hover {
  background-color: var(--black40a);
  border-color: var(--SmartThemeQuoteColor);
}

/* Focus 状态 */
select:focus {
  outline: 2px solid var(--SmartThemeQuoteColor);
  outline-offset: 2px;
}
```

### 2.2 下拉选项样式

```css
select option {
  background-color: var(--black70a);
  color: var(--SmartThemeBodyColor);
  padding: var(--spacing-sm);
}

select option:checked {
  background-color: var(--SmartThemeQuoteColor);
  color: var(--white100);
}

select option:hover {
  background-color: var(--black50a);
}
```

### 2.3 多选选择器

```css
select[multiple] {
  height: auto;
  min-height: 120px;
  padding: var(--spacing-xs);
}

select[multiple] option {
  padding: var(--spacing-xs) var(--spacing-sm);
  margin-bottom: 2px;
  border-radius: 3px;
}
```

---

## 3. 滑块 (Range Slider)

### 3.1 基础规范

**CSS定义**:
```css
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 6px;
  border-radius: 3px;
  background: var(--black50a);
  outline: none;
}

/* 滑块轨道 */
input[type="range"]::-webkit-slider-track {
  background: linear-gradient(to right, 
    var(--SmartThemeQuoteColor) 0%, 
    var(--SmartThemeQuoteColor) var(--value-percentage), 
    var(--black50a) var(--value-percentage)
  );
  border-radius: 3px;
}

/* 滑块按钮 */
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: var(--white100);
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  border: 2px solid var(--SmartThemeQuoteColor);
  transition: all var(--animation-duration) ease;
}

/* Hover 状态 */
input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.2);
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
}

/* Active 状态 */
input[type="range"]::-webkit-slider-thumb:active {
  transform: scale(1.1);
}
```

### 3.2 带标签的滑块

```css
.range-slider-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.range-slider-label {
  display: flex;
  justify-content: space-between;
  font-size: var(--fontSize-sm);
  color: var(--SmartThemeEmColor);
}

.range-slider-value {
  color: var(--SmartThemeQuoteColor);
  font-weight: 500;
}
```

---

## 4. 开关 (Toggle Switch)

### 4.1 基础规范

**CSS定义**:
```css
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

/* 滑块背景 */
.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--black50a);
  border-radius: 24px;
  transition: all var(--animation-duration) ease;
}

/* 滑块按钮 */
.toggle-slider:before {
  content: "";
  position: absolute;
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: var(--white100);
  border-radius: 50%;
  transition: all var(--animation-duration) ease;
}

/* Checked 状态 */
input:checked + .toggle-slider {
  background-color: var(--SmartThemeQuoteColor);
}

input:checked + .toggle-slider:before {
  transform: translateX(20px);
}

/* Disabled 状态 */
input:disabled + .toggle-slider {
  opacity: 0.5;
  cursor: not-allowed;
}
```

### 4.2 带标签的开关

```css
.toggle-wrapper {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.toggle-label {
  font-size: var(--mainFontSize);
  color: var(--SmartThemeBodyColor);
  cursor: pointer;
}
```

---

## 5. 复选框 (Checkbox)

### 5.1 基础规范

**CSS定义**:
```css
.checkbox-wrapper {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  gap: var(--spacing-xs);
}

input[type="checkbox"] {
  appearance: none;
  width: 18px;
  height: 18px;
  border: 2px solid var(--SmartThemeBorderColor);
  border-radius: 3px;
  background-color: var(--black30a);
  cursor: pointer;
  position: relative;
  transition: all var(--animation-duration) ease;
}

/* Hover 状态 */
input[type="checkbox"]:hover {
  border-color: var(--SmartThemeQuoteColor);
  background-color: var(--black40a);
}

/* Checked 状态 */
input[type="checkbox"]:checked {
  background-color: var(--SmartThemeQuoteColor);
  border-color: var(--SmartThemeQuoteColor);
}

/* 勾选标记 */
input[type="checkbox"]:checked::after {
  content: "";
  position: absolute;
  left: 5px;
  top: 2px;
  width: 4px;
  height: 8px;
  border: solid var(--white100);
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Disabled 状态 */
input[type="checkbox"]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
```

### 5.2 不确定状态

```css
input[type="checkbox"]:indeterminate {
  background-color: var(--SmartThemeQuoteColor);
  border-color: var(--SmartThemeQuoteColor);
}

input[type="checkbox"]:indeterminate::after {
  content: "";
  position: absolute;
  left: 3px;
  top: 7px;
  width: 10px;
  height: 2px;
  background-color: var(--white100);
  transform: none;
}
```

---

## 6. 单选框 (Radio Button)

### 6.1 基础规范

**CSS定义**:
```css
.radio-wrapper {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  gap: var(--spacing-xs);
}

input[type="radio"] {
  appearance: none;
  width: 18px;
  height: 18px;
  border: 2px solid var(--SmartThemeBorderColor);
  border-radius: 50%;
  background-color: var(--black30a);
  cursor: pointer;
  position: relative;
  transition: all var(--animation-duration) ease;
}

/* Hover 状态 */
input[type="radio"]:hover {
  border-color: var(--SmartThemeQuoteColor);
  background-color: var(--black40a);
}

/* Checked 状态 */
input[type="radio"]:checked {
  border-color: var(--SmartThemeQuoteColor);
  background-color: var(--black30a);
}

/* 选中标记 */
input[type="radio"]:checked::after {
  content: "";
  position: absolute;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: var(--SmartThemeQuoteColor);
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
```

---

## 7. 颜色选择器 (Color Picker)

### 7.1 基础规范

**CSS定义**:
```css
input[type="color"] {
  width: 40px;
  height: 40px;
  border: 2px solid var(--SmartThemeBorderColor);
  border-radius: 5px;
  padding: 2px;
  background-color: var(--black30a);
  cursor: pointer;
  transition: all var(--animation-duration) ease;
}

input[type="color"]::-webkit-color-swatch-wrapper {
  padding: 0;
  border-radius: 3px;
}

input[type="color"]::-webkit-color-swatch {
  border: none;
  border-radius: 3px;
}

/* Hover 状态 */
input[type="color"]:hover {
  border-color: var(--SmartThemeQuoteColor);
  transform: scale(1.05);
}
```

---

## 8. 文件上传 (File Input)

### 8.1 基础规范

**CSS定义**:
```css
.file-input-wrapper {
  position: relative;
  display: inline-block;
}

input[type="file"] {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.file-input-label {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-sm) var(--spacing-md);
  background-color: var(--black30a);
  border: 1px solid var(--SmartThemeBorderColor);
  border-radius: 5px;
  color: var(--SmartThemeBodyColor);
  cursor: pointer;
  transition: all var(--animation-duration) ease;
}

.file-input-label:hover {
  background-color: var(--black40a);
  border-color: var(--SmartThemeQuoteColor);
}

.file-input-icon {
  font-size: var(--fontSize-lg);
  color: var(--SmartThemeQuoteColor);
}

.file-input-text {
  font-size: var(--mainFontSize);
}
```

### 8.2 拖放区域

```css
.drop-zone {
  border: 2px dashed var(--SmartThemeBorderColor);
  border-radius: 8px;
  padding: var(--spacing-xl);
  text-align: center;
  background-color: var(--black20a);
  transition: all var(--animation-duration) ease;
  cursor: pointer;
}

.drop-zone.drag-over {
  border-color: var(--SmartThemeQuoteColor);
  background-color: var(--black40a);
}

.drop-zone-icon {
  font-size: var(--fontSize-3xl);
  color: var(--SmartThemeEmColor);
  margin-bottom: var(--spacing-sm);
}

.drop-zone-text {
  color: var(--SmartThemeBodyColor);
  font-size: var(--fontSize-md);
}
```

---

## 9. 表单布局

### 9.1 表单组

```css
.form-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
  margin-bottom: var(--spacing-md);
}

.form-label {
  font-size: var(--fontSize-sm);
  color: var(--SmartThemeBodyColor);
  font-weight: 500;
}

.form-label.required::after {
  content: "*";
  color: var(--error-color);
  margin-left: 4px;
}

.form-help {
  font-size: var(--fontSize-xs);
  color: var(--SmartThemeEmColor);
  margin-top: var(--spacing-xs);
}

.form-error {
  font-size: var(--fontSize-xs);
  color: var(--error-color);
  margin-top: var(--spacing-xs);
}
```

### 9.2 内联表单

```css
.form-inline {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.form-inline .form-group {
  flex: 1;
  margin-bottom: 0;
}
```

---

## 10. Figma 使用指南

### 10.1 创建输入框组件

1. **创建基础输入框**：
   - 绘制矩形（40px高）
   - 应用填充：`black30a`
   - 应用边框：`1px` + `SmartThemeBorderColor`
   - 圆角：`5px`
   - 添加文本占位符

2. **创建变体**：
   - 添加属性：`Type` = Default | Textarea | Search | Number | Password
   - 添加属性：`State` = Default | Hover | Focus | Error | Disabled
   - 添加属性：`Size` = Small | Medium | Large

3. **添加Auto Layout**：
   - 设置内边距：`8px 12px`
   - 响应式：`Hug` (垂直) + `Fill` (水平)

### 10.2 创建开关组件

1. **创建背景**：
   - 绘制圆角矩形：`44x24px`，圆角`24px`
   - 填充：`black50a`

2. **创建滑块**：
   - 绘制圆形：`18x18px`
   - 填充：`white100`
   - 位置：左侧偏移`3px`

3. **创建变体**：
   - 添加属性：`State` = Off | On
   - On状态：背景变为`SmartThemeQuoteColor`，滑块向右移动`20px`

### 10.3 导出为JSON

```json
{
  "textInput": {
    "default": {
      "height": "40px",
      "padding": "8px 12px",
      "background": "rgba(0, 0, 0, 0.3)",
      "border": "1px solid #555555",
      "borderRadius": "5px",
      "fontSize": "15px",
      "fontFamily": "Noto Sans"
    },
    "states": {
      "focus": {
        "outline": "2px solid #E18A24",
        "outlineOffset": "2px",
        "borderColor": "#E18A24"
      },
      "error": {
        "borderColor": "#F44336"
      }
    }
  },
  "toggle": {
    "width": "44px",
    "height": "24px",
    "borderRadius": "24px",
    "thumbSize": "18px",
    "states": {
      "off": {
        "background": "rgba(0, 0, 0, 0.5)"
      },
      "on": {
        "background": "#E18A24"
      }
    }
  }
}
```

---

## 11. Sketch 使用指南

### 11.1 创建Symbol

1. **输入框Symbol**：
   - 创建矩形 + 文本层
   - 转换为Symbol：`Form/Input/Default`
   - 添加Override：State, Size

2. **开关Symbol**：
   - 创建嵌套Symbol：Background + Thumb
   - 使用Smart Layout自动调整

### 11.2 创建Library

1. 创建文档：`SillyTavern-Forms.sketch`
2. 添加所有表单组件Symbol
3. 发布为Library供其他文件使用

---

## 12. 无障碍性

### 12.1 键盘导航

- 所有控件支持`Tab`键聚焦
- `Enter`/`Space`触发按钮和开关
- `Arrow Keys`调整滑块和选择器

### 12.2 屏幕阅读器

```html
<label for="username">用户名</label>
<input 
  type="text" 
  id="username" 
  aria-required="true"
  aria-describedby="username-help"
>
<span id="username-help">请输入3-20个字符</span>
```

### 12.3 焦点指示

所有控件必须有清晰的焦点状态（2px outline）

---

## 13. 交互动画

### 13.1 过渡时长

```css
/* 所有控件的状态变化 */
transition: all 125ms ease;

/* 滑块拖动 */
transition: transform 0ms;  /* 拖动时无延迟 */
```

### 13.2 微交互

- **输入框获得焦点**：轮廓线淡入
- **开关切换**：滑块滑动 + 背景色渐变
- **复选框勾选**：勾选标记缩放弹出

---

## 相关文档

- [01-设计令牌](./01-设计令牌.md) - 所有CSS变量定义
- [02-颜色系统](./02-颜色系统.md) - 颜色应用规范
- [03-排版系统](./03-排版系统.md) - 文字样式
- [12-聊天界面](./12-聊天界面.md) - 表单控件在聊天中的应用

---

**最后更新**: 2025-12-21 | **版本**: 1.0.0
